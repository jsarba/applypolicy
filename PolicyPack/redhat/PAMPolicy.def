#PAM Config
# Special section only for Linux Platform. 
# These special sections can found into applypolicy's main file instead of lib directory.
Section = PAMPolicy
        PAM_other@1 = "auth:required:/lib/security/$ISA/pam_warn.so"
        PAM_other@2 = "auth:required:/lib/security/$ISA/pam_deny.so"
        PAM_other@3 = "account:required:/lib/security/$ISA/pam_warn.so"
        PAM_other@4 = "account:required:/lib/security/$ISA/pam_deny.so"
        PAM_other@5 = "password:required:/lib/security/$ISA/pam_warn.so"
        PAM_other@6 = "password:required:/lib/security/$ISA/pam_deny.so"
        PAM_other@7 = "session:required:/lib/security/$ISA/pam_warn.so"
        PAM_other@8 = "session:required:/lib/security/$ISA/pam_deny.so"
        PAM_login@1 = "auth:required:pam_securetty.so"
        PAM_login@2 = "auth:required:pam_stack.so service=system-auth"
        PAM_login@3 = "auth:required:pam_nologin.so"
        PAM_login@4 = "auth:required:pam_shells.so"
        PAM_login@5 = "account:required:pam_stack.so service=system-auth"
        PAM_login@6 = "password:required:pam_stack.so service=system-auth"
        PAM_login@7 = "session:required:pam_stack.so service=system-auth"
        PAM_login@8 = "session:optional:pam_console.so"
        PAM_login@9 = "session:optional:pam_lastlog.so"
        PAM_login@10 = "session:optional:pam_motd.so"
        PAM_passwd@1 = "auth:required:pam_stack.so service=system-auth"
        PAM_passwd@2 = "account:required:pam_stack.so service=system-auth"
        PAM_passwd@3 = "password:required:pam_stack.so service=system-auth"
        PAM_sshd@1 = "auth:required:pam_stack.so service=system-auth"
        PAM_sshd@2 = "auth:required:pam_nologin.so"
        PAM_sshd@3 = "auth:required:pam_shells.so"
        PAM_sshd@4 = "account:required:pam_access.so"
        PAM_sshd@5 = "account:required:pam_stack.so service=system-auth"
        PAM_sshd@6 = "password:required:pam_stack.so service=system-auth"
        PAM_sshd@7 = "session:required:pam_stack.so service=system-auth"
        PAM_sshd@8 = "session:optional:pam_console.so"
        PAM_su@1 = "auth:sufficient:pam_rootok.so"
        PAM_su@2 = "auth:required:pam_wheel.so use_uid group=zusers"
        PAM_su@3 = "auth:required:pam_stack.so service=system-auth"
        PAM_su@4 = "account:required:pam_stack.so service=system-auth"
        PAM_su@5 = "password:required:pam_stack.so service=system-auth"
        PAM_su@6 = "session:required:pam_stack.so service=system-auth"
        PAM_su@7= "session:optional:pam_xauth.so"
        PAM_system-auth@1 = "auth:required:/lib/security/$ISA/pam_env.so"
        PAM_system-auth@2 = "auth:sufficient:/lib/security/$ISA/pam_unix.so likeauth nullok"
        PAM_system-auth@3 = "auth:required:/lib/security/$ISA/pam_deny.so"
        PAM_system-auth@4 = "account:required:/lib/security/$ISA/pam_access.so"
        PAM_system-auth@5 = "account:required:/lib/security/$ISA/pam_unix.so"
        PAM_system-auth@6 = "password:required:/lib/security/$ISA/pam_cracklib.so retry=4 minlen=6 type="
        PAM_system-auth@7 = "password:sufficient:/lib/security/$ISA/pam_unix.so nullok use_authtok md5 shadow"
        PAM_system-auth@8 = "password:required:/lib/security/$ISA/pam_deny.so"
        PAM_system-auth@9 = "session:required:/lib/security/$ISA/pam_limits.so"
        PAM_system-auth@10 = "session:required:/lib/security/$ISA/pam_unix.so"
        PAM_halt@1 = "auth:sufficient:pam_rootok.so"
        PAM_halt@2 = "auth:required:pam_console.so"
        PAM_halt@3 = "account:required:pam_permit.so"
        PAM_poweroff@1 = "auth:sufficient:pam_rootok.so"
        PAM_poweroff@2 = "auth:required:pam_console.so"
        PAM_poweroff@3 = "account:required:pam_permit.so"
        PAM_reboot@1 = "auth:sufficient:pam_rootok.so"
        PAM_reboot@2 = "auth:required:pam_console.so"
        PAM_reboot@3 = "account:required:pam_permit.so"
        PAM_sudo@1 = "auth:required:pam_stack.so service=system-auth"
        PAM_sudo@2 = "account:required:pam_stack.so service=system-auth"
        PAM_sudo@3 = "password:required:pam_stack.so service=system-auth"
        PAM_sudo@4 = "session:required:pam_stack.so service=system-auth"
        PAM_authconfig@1 = "auth:sufficient:/lib/security/$ISA/pam_rootok.so"
        PAM_authconfig@2 = "auth:required:/lib/security/$ISA/pam_stack.so service=system-auth"
        PAM_authconfig@3 = "account:required:/lib/security/$ISA/pam_permit.so"
        PAM_authconfig@4 = "session:required:/lib/security/$ISA/pam_permit.so"
EndSection
